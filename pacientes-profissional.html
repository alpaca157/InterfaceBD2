<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVITTA - Pacientes do Profissional</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>AVITTA</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="menu.html" class="nav-item">
                    <span class="nav-icon">üè†</span>
                    <span>Iniciar</span>
                </a>
                <a href="cadastro.html" class="nav-item">
                    <span class="nav-icon">üìù</span>
                    <span>Cadastrar</span>
                </a>
                <a href="consultas.html" class="nav-item">
                    <span class="nav-icon">üìã</span>
                    <span>Registros</span>
                </a>
                <a href="profissionais.html" class="nav-item active">
                    <span class="nav-icon">üë®‚Äç‚öïÔ∏è</span>
                    <span>Profissionais</span>
                </a>
                <a href="alertas.html" class="nav-item">
                    <span class="nav-icon">‚ö†Ô∏è</span>
                    <span>Alertas</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <button class="btn-logout" onclick="logout()">Sair</button>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-header">
                <h1>Pacientes do Profissional</h1>
                <button class="btn-voltar" onclick="voltar()">‚Üê Voltar</button>
            </header>

            <div class="content-wrapper">
                <div class="profissional-info">
                    <h2 id="nome-profissional">Profissional ID: <span id="id-profissional-display"></span></h2>
                    <p>Total de pacientes ativos: <strong id="total-pacientes">0</strong></p>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID Paciente</th>
                                <th>Nome</th>
                                <th>CPF</th>
                                <th>Data de In√≠cio do V√≠nculo</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-pacientes-profissional">
                            <!-- Dados ser√£o carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
    <script>
        // Carregar pacientes do profissional ao iniciar
        document.addEventListener('DOMContentLoaded', function() {
            const idProfissional = sessionStorage.getItem('profissional_selecionado');
            
            if (!idProfissional) {
                alert('Nenhum profissional selecionado!');
                window.location.href = 'profissionais.html';
                return;
            }

            document.getElementById('id-profissional-display').textContent = idProfissional;

            // Simula√ß√£o de dados (na pr√°tica viria do banco de dados)
            // Usando a consulta: Listar todos os pacientes de um profissional - Ativo
            carregarPacientesProfissional(idProfissional);
        });

        function carregarPacientesProfissional(idProfissional) {
            // Dados simulados baseados no seu banco de dados
            const pacientesPorProfissional = {
                '1': [
                    { id: 1, nome: 'Ana Araujo', cpf: '000.000.000-01', dataInicio: '2026-01-10', status: 'ATIVO' },
                    { id: 2, nome: 'Beatriz Barros', cpf: '000.000.000-02', dataInicio: '2026-01-26', status: 'ATIVO' },
                    { id: 7, nome: 'Gabriela Gomes', cpf: '000.000.000-07', dataInicio: '2026-01-12', status: 'ATIVO' },
                    { id: 11, nome: 'Karina Kruger', cpf: '000.000.000-11', dataInicio: '2026-01-06', status: 'ATIVO' }
                ],
                '2': [
                    { id: 5, nome: 'Eduarda Esteves', cpf: '000.000.000-05', dataInicio: '2026-01-02', status: 'ATIVO' },
                    { id: 8, nome: 'Helena Hoffmann', cpf: '000.000.000-08', dataInicio: '2026-01-08', status: 'ATIVO' },
                    { id: 12, nome: 'Larissa Lima', cpf: '000.000.000-12', dataInicio: '2026-01-09', status: 'ATIVO' }
                ],
                '3': [
                    { id: 3, nome: 'Camila Cardoso', cpf: '000.000.000-03', dataInicio: '2026-01-20', status: 'ATIVO' },
                    { id: 6, nome: 'Fernanda Freitas', cpf: '000.000.000-06', dataInicio: '2026-01-25', status: 'ATIVO' },
                    { id: 9, nome: 'Isabela Iglesias', cpf: '000.000.000-09', dataInicio: '2026-01-18', status: 'ATIVO' }
                ],
                '5': [
                    { id: 4, nome: 'Daniela Dias', cpf: '000.000.000-04', dataInicio: '2026-01-15', status: 'ATIVO' },
                    { id: 10, nome: 'Julia Junqueira', cpf: '000.000.000-10', dataInicio: '2026-01-03', status: 'ATIVO' }
                ]
            };

            const pacientes = pacientesPorProfissional[idProfissional] || [];
            
            const tbody = document.getElementById('tabela-pacientes-profissional');
            tbody.innerHTML = '';

            if (pacientes.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #999;">
                            Nenhum paciente vinculado a este profissional
                        </td>
                    </tr>
                `;
                document.getElementById('total-pacientes').textContent = '0';
                return;
            }

            pacientes.forEach(paciente => {
                const tr = document.createElement('tr');
                tr.onclick = function(e) {
                    if (!e.target.closest('button')) {
                        verProntuario(paciente.id);
                    }
                };
                
                tr.innerHTML = `
                    <td>${paciente.id}</td>
                    <td>${paciente.nome}</td>
                    <td>${paciente.cpf}</td>
                    <td>${formatarData(paciente.dataInicio)}</td>
                    <td><span class="status-${paciente.status.toLowerCase()}">${paciente.status}</span></td>
                    <td>
                        <button class="btn-action" onclick="verProntuario(${paciente.id})">üìÑ Prontu√°rio</button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });

            document.getElementById('total-pacientes').textContent = pacientes.length;
        }

        function formatarData(dataISO) {
            if (!dataISO) return '-';
            const [ano, mes, dia] = dataISO.split('-');
            return `${dia}/${mes}/${ano}`;
        }
    </script>
</body>
</html>